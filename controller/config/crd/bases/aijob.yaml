apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: aijobs.aiplatform.example.com
spec:
  group: aiplatform.example.com
  names:
    kind: AIJob
    listKind: AIJobList
    plural: aijobs
    singular: aijob
  scope: Namespaced
  versions:
  - name: v1alpha1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              jobType:
                type: string
                enum: [inference, training, evaluation, simulation]
              priority:
                type: string
                enum: [high, medium, low]
              preemptible:
                type: boolean
              gang:
                 type: object
                 properties:
                   enabled:
                     type: boolean
                   minMembers:
                     type: integer
              image:
                type: string
              resources:
                type: object
                properties:
                  cpu:
                    type: string
                  memory:
                    type: string
                  gpu:
                    type: string
              inputData:
                type: object
                properties:
                  source:
                    type: string
                  format:
                    type: string
                    enum: [tensor, numpy, raw]
              outputData:
                type: object
                properties:
                  destination:
                    type: string
              model:
                type: object
                properties:
                  path:
                    type: string
                  framework:
                    type: string
              timeout:
                type: integer
              retries:
                type: integer
              concurrency:
                type: integer
          status:
            type: object
            properties:
              phase:
                type: string
                enum: [Pending, Running, Succeeded, Failed]
              startTime:
                type: string
                format: date-time
              completionTime:
                type: string
                format: date-time
              metrics:
                type: object
                properties:
                  latencyP50:
                    type: string
                  latencyP99:
                    type: string
                  throughput:
                    type: string
    additionalPrinterColumns:
    - name: Phase
      type: string
      jsonPath: .status.phase
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp
